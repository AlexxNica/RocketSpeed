JAVA_VERSION = '7'

java_library(
    name = 'client_java',
    srcs =
        util.files('main/java/org/rocketspeed/*.java') +
        util.files('main/java/org/rocketspeed/android/*.java') +
        util.files('main/java-gen/org/rocketspeed/*.java'),
    deps = [
        '@/rocketspeed/github/src/djinni:librocketspeedjni.so',
    ],
)

java_unittest(
    name = 'client_java_test',
    srcs = util.files('test/java/**/*.java'),
    deps = [
        ':client_java',
        '@/rocketspeed/github/src/test:test_cluster_proc',
    ],
    aether_deps = [
        'org.mockito:mockito-all:1.9.5',
    ],
    test_classes = [
        'org.rocketspeed.BuilderTest',
        'org.rocketspeed.IntegrationTest',
        'org.rocketspeed.LocalTestClusterTest',
        'org.rocketspeed.android.WakeLockTest',
        'org.rocketspeed.tests.VisibilityTest',
    ],
    tags = [
        'serialize',
        'serialize_test_cases',
    ],
    env = {
        'RS_CLUSTER_BIN_PATH' : '_bin/rocketspeed/github/src/test/test_cluster_proc',
        'LD_LIBRARY_PATH' : '_bin/rocketspeed/github/src/djinni',
    },
    java_version = JAVA_VERSION,
    openjdk = True,
)
