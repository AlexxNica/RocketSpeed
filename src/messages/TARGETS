cpp_library(
    name = 'messages',
    headers = AutoHeaders.RECURSIVE_GLOB,
    srcs = [
        'descriptor_event.cc',
        'messages.cc',
        'msg_loop.cc',
        'wrapped_message.cc',
        'load_balancer.cc',
    ],
    preprocessor_flags = [
        '-Irocketspeed/github',
        '-DROCKETSPEED_PLATFORM_POSIX=1',
        '-DOS_LINUX=1',
    ],
    deps = [
        '@/rocketspeed/github/src/port:port',
        '@/rocketspeed/github/src/util/common:common',
        '@/rocketspeed/github/src/util:util',
        ':event_loop',
    ],
)

cpp_library(
    name = 'event_loop',
    headers = AutoHeaders.RECURSIVE_GLOB,
    srcs = [
        'event_callback.cc',
        'event_loop.cc',
        'flow_control.cc',
        'socket_event.cc',
        'stream.cc',
        'timed_callback.cc',
        'triggerable_callback.cc',
        'combined_callback.cc',
        'types.cc',
    ],
    preprocessor_flags = [
        '-Irocketspeed/github',
        '-DROCKETSPEED_PLATFORM_POSIX=1',
        '-DOS_LINUX=1',
    ],
    deps = [
        ':queues',
        '@/rocketspeed/github/src/port:port',
        '@/rocketspeed/github/src/util/common:common',
        '@/rocketspeed/github/src/util:util',
        '@/logdevice/external/libevent-2.1.3-alpha:event_core',
    ],
    compiler_flags = [
        '-Ilogdevice/external/libevent-2.1.3-alpha/include',
    ],
)

cpp_library(
    name = 'queues',
    headers = AutoHeaders.RECURSIVE_GLOB,
    srcs = [
        'queues.cc',
    ],
    preprocessor_flags = [
        '-Irocketspeed/github',
        '-DROCKETSPEED_PLATFORM_POSIX=1',
    ],
    deps = [
        '@/rocketspeed/github/src/util/common:common',
        '@/rocketspeed/github/src/util:util',
        '@/rocketspeed/github/external/folly:headers',
    ],
)
